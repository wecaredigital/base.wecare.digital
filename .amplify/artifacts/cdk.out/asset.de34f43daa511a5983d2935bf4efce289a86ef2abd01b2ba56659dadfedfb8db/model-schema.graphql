type Contact @model @auth(rules: [{allow: private}])
{
  contactId: ID! @primaryKey
  name: String
  phone: String @index(queryField: "listContactByPhone")
  email: String @index(queryField: "listContactByEmail")
  optInWhatsApp: Boolean @default(value: "false")
  optInSms: Boolean @default(value: "false")
  optInEmail: Boolean @default(value: "false")
  allowlistWhatsApp: Boolean @default(value: "false")
  allowlistSms: Boolean @default(value: "false")
  allowlistEmail: Boolean @default(value: "false")
  lastInboundMessageAt: AWSDateTime
  createdAt: AWSDateTime
  updatedAt: AWSDateTime
  deletedAt: AWSDateTime
}

type Message @model @auth(rules: [{allow: private}])
{
  messageId: ID! @primaryKey
  contactId: String! @index(queryField: "listMessageByContactId")
  channel: MessageChannel
  direction: MessageDirection
  content: String
  timestamp: AWSDateTime
  status: MessageStatus
  errorDetails: String
  whatsappMessageId: String @index(queryField: "listMessageByWhatsappMessageId")
  mediaId: String
  expiresAt: Int
}

type BulkJob @model @auth(rules: [{allow: private}])
{
  jobId: ID! @primaryKey
  createdBy: String!
  channel: BulkJobChannel
  totalRecipients: Int
  sentCount: Int @default(value: "0")
  failedCount: Int @default(value: "0")
  status: BulkJobStatus
  createdAt: AWSDateTime
  updatedAt: AWSDateTime
}

type BulkRecipient @model @auth(rules: [{allow: private}])
{
  jobId: String! @primaryKey(sortKeyFields: ["recipientId"])
  recipientId: String!
  contactId: String!
  status: BulkRecipientStatus
  sentAt: AWSDateTime
  errorDetails: String
}

type User @model @auth(rules: [{allow: private}])
{
  userId: ID! @primaryKey
  email: String! @index(queryField: "listUserByEmail")
  role: UserRole
  createdAt: AWSDateTime
  lastLoginAt: AWSDateTime
}

type MediaFile @model @auth(rules: [{allow: private}])
{
  fileId: ID! @primaryKey
  messageId: String! @index(queryField: "listMediaFileByMessageId")
  s3Key: String!
  contentType: String
  size: Int
  uploadedAt: AWSDateTime
  whatsappMediaId: String
}

type DLQMessage @model @auth(rules: [{allow: private}])
{
  dlqMessageId: ID! @primaryKey
  originalMessageId: String
  queueName: String!
  retryCount: Int @default(value: "0")
  lastAttemptAt: AWSDateTime
  payload: String
  expiresAt: Int
}

type AuditLog @model @auth(rules: [{allow: private}])
{
  logId: ID! @primaryKey
  userId: String
  action: String!
  resourceType: String
  resourceId: String
  timestamp: AWSDateTime
  details: String
  expiresAt: Int
}

type AIInteraction @model @auth(rules: [{allow: private}])
{
  interactionId: ID! @primaryKey
  messageId: String @index(queryField: "listAIInteractionByMessageId")
  query: String
  response: String
  approved: Boolean @default(value: "false")
  feedback: String
  timestamp: AWSDateTime
}

type RateLimitTracker @model @auth(rules: [{allow: private}])
{
  channel: String! @primaryKey(sortKeyFields: ["windowStart"])
  windowStart: String!
  messageCount: Int @default(value: "0")
  lastUpdatedAt: Int
}

type SystemConfig @model @auth(rules: [{allow: private}])
{
  configKey: String! @primaryKey
  configValue: String
  updatedBy: String
  updatedAt: AWSDateTime
}

type VoiceCall @model @auth(rules: [{allow: private}])
{
  callId: ID! @primaryKey
  contactId: String @index(queryField: "listVoiceCallByContactId")
  phoneNumber: String! @index(queryField: "listVoiceCallByPhoneNumber")
  provider: VoiceCallProvider
  callType: VoiceCallCallType
  direction: VoiceCallDirection
  status: VoiceCallStatus
  duration: Int @default(value: "0")
  recordingUrl: String
  providerCallId: String
  createdAt: AWSDateTime
  updatedAt: AWSDateTime
  expiresAt: Int
}

enum MessageChannel {
  WHATSAPP
  SMS
  EMAIL
}

enum MessageDirection {
  INBOUND
  OUTBOUND
}

enum MessageStatus {
  PENDING
  SENT
  DELIVERED
  READ
  FAILED
}

enum BulkJobChannel {
  WHATSAPP
  SMS
  EMAIL
}

enum BulkJobStatus {
  PENDING
  IN_PROGRESS
  PAUSED
  COMPLETED
  CANCELLED
  FAILED
}

enum BulkRecipientStatus {
  PENDING
  SENT
  FAILED
}

enum UserRole {
  VIEWER
  OPERATOR
  ADMIN
}

enum VoiceCallProvider {
  AWS
  AIRTEL
}

enum VoiceCallCallType {
  TTS
  AUDIO
  IVR
  CLICK_TO_CALL
}

enum VoiceCallDirection {
  INBOUND
  OUTBOUND
}

enum VoiceCallStatus {
  INITIATED
  RINGING
  IN_PROGRESS
  COMPLETED
  FAILED
  NO_ANSWER
  BUSY
}